# ðŸ§  æœºå™¨å­¦ä¹ ï¼šæ–‡æ¡£åˆ†ç±»

**ç­–ç•¥ç±»åž‹**: æœºå™¨å­¦ä¹ /è‡ªç„¶è¯­è¨€å¤„ç†
**æ¥æº**: QuantStart (quantstart.com)

---

## ðŸ“‹ ç­–ç•¥æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰å’Œ Scikit-Learn è¿›è¡Œæ–‡æ¡£åˆ†ç±»çš„æŠ€æœ¯æ–‡ç« ã€‚è™½ç„¶ä¸æ˜¯ç›´æŽ¥çš„äº¤æ˜“ç­–ç•¥ï¼Œä½†**æ–‡æ¡£åˆ†ç±»æŠ€æœ¯å¯¹é‡åŒ–äº¤æ˜“éžå¸¸é‡è¦**ã€‚

### åº”ç”¨åœºæ™¯

æ–‡æ¡£åˆ†ç±»å¯ä»¥åº”ç”¨äºŽï¼š
- è‡ªåŠ¨è¯†åˆ«äº¤æ˜“ç­–ç•¥æŠ¥å‘Šï¼ˆPDFã€HTMLï¼‰
- æ–°é—»å’Œæ–‡ç« åˆ†ç±»ï¼ˆç‰›å¸‚/ç†Šå¸‚/éœ‡è¡å¸‚ï¼‰
- ç ”ç©¶è®ºæ–‡åˆ†ç±»ï¼ˆåŠ¨é‡/å‡å€¼å›žå½’/è¶‹åŠ¿è·Ÿè¸ªï¼‰
- å®¢æˆ·é‚®ä»¶åˆ†ç±»ï¼ˆæŠ•è¯‰/å’¨è¯¢/å»ºè®®/é—®é¢˜ï¼‰

### æ ¸å¿ƒæŠ€æœ¯

#### 1. æ•°æ®é¢„å¤„ç†
- æ–‡æœ¬æ¸…æ´—
- åŽ»é™¤ HTML æ ‡ç­¾
- åŽ»é™¤åœç”¨è¯
- è¯å¹²åŒ–

#### 2. ç‰¹å¾å·¥ç¨‹ï¼ˆFeature Engineeringï¼‰
- TF-IDFï¼ˆTerm Frequency - Inverse Document Frequencyï¼‰
- è¯è¢‹æ¨¡åž‹ï¼ˆBag of Wordsï¼‰
- N-gram ç‰¹å¾
- è¯åµŒå…¥ï¼ˆWord Embeddingsï¼‰

#### 3. æ¨¡åž‹é€‰æ‹©
- **æœ´ç´ è´å¶æ–¯ï¼ˆNaive Bayesï¼‰**ï¼šç®€å•å¿«é€Ÿ
- **æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰**ï¼šé€‚åˆé«˜ç»´æ•°æ®
- **éšæœºæ£®æž—ï¼ˆRandom Forestï¼‰**ï¼šé²æ£’æ€§å¼º
- **æ¢¯åº¦æå‡ï¼ˆXGBoost/LightGBMï¼‰**ï¼šæ€§èƒ½æœ€ä½³
- **æ·±åº¦å­¦ä¹ ï¼ˆLSTM/Transformerï¼‰**ï¼šé€‚åˆåºåˆ—æ•°æ®

#### 4. æ¨¡åž‹è¯„ä¼°
- å‡†ç¡®çŽ‡
- å¬å›žçŽ‡
- F1 åˆ†æ•°
- AUC-ROC æ›²çº¿

---

## ðŸ§  ç­–ç•¥é€»è¾‘

### ç›‘ç£å­¦ä¹ åˆ†ç±»æµç¨‹

#### æ­¥éª¤ 1ï¼šæ•°æ®å‡†å¤‡
```python
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.preprocessing import LabelEncoder

# å‡è®¾æˆ‘ä»¬æœ‰æ–‡æ¡£æ•°æ®é›†
documents = [...]  # æ–‡æœ¬åˆ—è¡¨
labels = [...]  # ç±»åˆ«åˆ—è¡¨ï¼ˆbull_market, bear_market, momentum, etc.ï¼‰

# æ–‡æœ¬è½¬å‘é‡
vectorizer = TfidfVectorizer(max_features=1000)
X = vectorizer.fit_transform(documents)

# æ ‡ç­¾ç¼–ç 
encoder = LabelEncoder()
y = encoder.fit_transform(labels)

# åˆ†å‰²è®­ç»ƒé›†å’Œæµ‹è¯•é›†
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)
```

#### æ­¥éª¤ 2ï¼šæ¨¡åž‹è®­ç»ƒ
```python
from sklearn.ensemble import RandomForestClassifier

# åˆ›å»ºæ¨¡åž‹
model = RandomForestClassifier(n_estimators=100, random_state=42)

# è®­ç»ƒ
model.fit(X_train, y_train)

# è¯„ä¼°
accuracy = model.score(X_test, y_test)
print(f"Accuracy: {accuracy:.2f}")
```

#### æ­¥éª¤ 3ï¼šæ¨¡åž‹åº”ç”¨
```python
# é¢„æµ‹æ–°æ–‡æ¡£
new_document = "S&P 500 hits new high, market expects continued rally..."
new_document_vectorized = vectorizer.transform([new_document])
prediction = model.predict(new_document_vectorized)

# è¾“å‡ºç±»åˆ«
print(f"Document category: {encoder.inverse_transform(prediction)}")
```

---

## ðŸ“Š éœ€è¦çš„æ•°æ®

### 1. æ–‡æœ¬æ•°æ®
- âœ… æ–‡æ¡£æ–‡æœ¬ï¼ˆHTML, PDF, çº¯æ–‡æœ¬ï¼‰
- âœ… æ ‡é¢˜å’Œæ‘˜è¦
- âœ… æ®µè½å’Œå†…å®¹

### 2. æ ‡ç­¾æ•°æ®ï¼ˆå¦‚æžœä½¿ç”¨ç›‘ç£å­¦ä¹ ï¼‰
- âœ… æ–‡æ¡£ç±»åˆ«æ ‡ç­¾ï¼ˆbull_market, bear_market, sideway, etc.ï¼‰
- âœ… ç­–ç•¥ç±»åž‹æ ‡ç­¾ï¼ˆmomentum, mean_reversion, breakout, etc.ï¼‰
- âœ… æƒ…ç»ªæ ‡ç­¾ï¼ˆpositive, negative, neutralï¼‰

### 3. å¤–éƒ¨æ•°æ®ï¼ˆå¢žå¼ºåˆ†ç±»ï¼‰
- âœ… å¸‚åœºæ•°æ®ï¼ˆä»·æ ¼ã€æˆäº¤é‡ã€æ³¢åŠ¨çŽ‡ï¼‰
- âœ… ç»æµŽæ•°æ®ï¼ˆåˆ©çŽ‡ã€é€šèƒ€ã€GDPï¼‰
- âœ… æ–°é—»å’Œäº‹ä»¶æ•°æ®ï¼ˆè´¢æŠ¥ã€å¤®è¡Œå†³è®®ï¼‰
- âœ… ç¤¾äº¤åª’ä½“æ•°æ®ï¼ˆTwitterã€Redditã€æ–°é—»æƒ…ç»ªï¼‰

---

## âœ… ç­–ç•¥æœ‰æ•ˆæ€§åŽŸå› 

### ä¸ºä»€ä¹ˆæœºå™¨å­¦ä¹ å¯¹é‡åŒ–äº¤æ˜“æœ‰æ•ˆï¼Ÿ

#### 1. **æ¨¡å¼è¯†åˆ«èƒ½åŠ›**
- ML å¯ä»¥è¯†åˆ«äººç±»æ— æ³•å‘çŽ°çš„å¸‚åœºæ¨¡å¼
- èƒ½å¤„ç†é«˜ç»´æ•°æ®ï¼ˆå¤šä¸ªæŠ€æœ¯æŒ‡æ ‡ã€æ–°é—»ã€äº‹ä»¶ï¼‰
- èƒ½å‘çŽ°éžçº¿æ€§å…³ç³»

#### 2. **è‡ªåŠ¨åŒ–èƒ½åŠ›**
- è‡ªåŠ¨åˆ†ç±»æ–°é—»å’Œå¸‚åœºæƒ…ç»ª
- è‡ªåŠ¨è¯†åˆ«å¸‚åœºçŠ¶æ€ï¼ˆç‰›å¸‚/ç†Šå¸‚/éœ‡è¡å¸‚ï¼‰
- è‡ªåŠ¨ç”Ÿæˆäº¤æ˜“ä¿¡å·

#### 3. **é€‚åº”æ€§**
- æ¨¡åž‹å¯ä»¥æŒç»­å­¦ä¹ å’Œé€‚åº”
- èƒ½æ•æ‰å¸‚åœºçŽ¯å¢ƒçš„å˜åŒ–
- èƒ½è¯†åˆ«æ–°çš„äº¤æ˜“æœºä¼š

#### 4. **æ•°æ®é©±åŠ¨å†³ç­–**
- åŸºäºŽåŽ†å²æ•°æ®éªŒè¯ç­–ç•¥
- é¿å…æƒ…ç»ªåŒ–äº¤æ˜“
- æä¾›å®¢è§‚çš„äº¤æ˜“ä¿¡å·

#### 5. **å›žæµ‹å’ŒéªŒè¯**
- å¯ä»¥å¯¹ ML æ¨¡åž‹è¿›è¡Œä¸¥æ ¼å›žæµ‹
- å¯ä»¥è®¡ç®—æœŸæœ›æ”¶ç›Šå’Œé£Žé™©æŒ‡æ ‡
- å¯ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼ˆä½¿ç”¨äº¤å‰éªŒè¯ï¼‰

---

## âš ï¸ é£Žé™©å’Œæ³¨æ„äº‹é¡¹

### ä¸»è¦é£Žé™©

#### 1. **è¿‡æ‹Ÿåˆé£Žé™©**
- âš ï¸ ML æ¨¡åž‹åœ¨åŽ†å²æ•°æ®ä¸Šè¡¨çŽ°å¾ˆå¥½ï¼Œä½†åœ¨æœªæ¥å¯èƒ½å¤±æ•ˆ
- âš ï¸ é¿å…"æ›²çº¿æ‹Ÿåˆ"ï¼ˆCurve Fittingï¼‰
- **è§£å†³æ–¹æ³•**ï¼š
  - ä½¿ç”¨äº¤å‰éªŒè¯
  - ä¿ç•™éªŒè¯é›†
  - æ­£åˆ™åŒ–ï¼ˆL1/L2 æ­£åˆ™åŒ–ï¼‰
  - æå‰åœæ­¢ï¼ˆEarly Stoppingï¼‰

#### 2. **æ•°æ®è´¨é‡é—®é¢˜**
- âš ï¸ åžƒåœ¾æ•°æ®ï¼ˆGarbage Inï¼‰ä¼šå½±å“æ¨¡åž‹æ€§èƒ½
- âš ï¸ æ•°æ®ä¸å¹³è¡¡ï¼ˆæ­£è´Ÿæ ·æœ¬ä¸å‡è¡¡ï¼‰ä¼šå¯¼è‡´åå€š
- **è§£å†³æ–¹æ³•**ï¼š
  - æ•°æ®æ¸…æ´—å’ŒåŽ»å™ª
  - ä½¿ç”¨ SMOTE ç­‰é‡‡æ ·æŠ€æœ¯
  - ä½¿ç”¨ Focal Loss æˆ–ç±»åˆ«æƒé‡

#### 3. **æ¦‚å¿µæ¼‚ç§»ï¼ˆConcept Driftï¼‰**
- âš ï¸ å¸‚åœºçŽ¯å¢ƒå˜åŒ–å¯¼è‡´æ¨¡åž‹å¤±æ•ˆ
- âš ï¸ æ–°çš„å¸‚åœºåŠ¨æ€æ— æ³•è¢«æ—§æ¨¡åž‹æ•æ‰
- **è§£å†³æ–¹æ³•**ï¼š
  - åœ¨çº¿å­¦ä¹ ï¼ˆæŒç»­æ›´æ–°æ¨¡åž‹ï¼‰
  - æ¦‚å¿µæ¼‚ç§»æ£€æµ‹
  - å‘¨æœŸæ€§é‡æ–°è®­ç»ƒæ¨¡åž‹

#### 4. **é»‘ç®±é£Žé™©ï¼ˆBlack Boxï¼‰**
- âš ï¸ å¤æ‚çš„ ML æ¨¡åž‹éš¾ä»¥è§£é‡Š
- âš ï¸ äº¤æ˜“è€…å¯èƒ½ä¸ä¿¡ä»»æ¨¡åž‹çš„å†³ç­–
- **è§£å†³æ–¹æ³•**ï¼š
  - ä½¿ç”¨å¯è§£é‡Šæ¨¡åž‹ï¼ˆå†³ç­–æ ‘ã€é€»è¾‘å›žå½’ï¼‰
  - æ·»åŠ ç‰¹å¾é‡è¦æ€§åˆ†æžï¼ˆSHAPã€LIMEï¼‰
  - æä¾›é¢„æµ‹ç½®ä¿¡åŒºé—´

---

## ðŸŽ¯ å®žæ–½å»ºè®®

### åœ¨ Backtrader ä¸­é›†æˆ

è™½ç„¶è¿™ä¸æ˜¯ç›´æŽ¥çš„äº¤æ˜“ç­–ç•¥ï¼Œä½†å¯ä»¥ï¼š

#### 1. ä½œä¸ºé¢„ç­›é€‰å™¨
- ä½¿ç”¨ ML æ¨¡åž‹ç­›é€‰æ½œåœ¨çš„äº¤æ˜“æœºä¼š
- å°†åˆ†ç±»ç»“æžœä½œä¸ºä¿¡å·æº
- ä¾‹å¦‚ï¼šè¯†åˆ«å‡º"å¼ºåŠ¿åŠ¨é‡è‚¡"ï¼Œä½œä¸ºä¹°å…¥å€™é€‰

#### 2. æƒ…ç»ªåˆ†æž
- å¯¹æ–°é—»ã€ç¤¾äº¤åª’ä½“è¿›è¡Œ NLP åˆ†æž
- ç”Ÿæˆå¸‚åœºæƒ…ç»ªæŒ‡æ ‡
- ä½œä¸ºç­–ç•¥çš„è¾…åŠ©ä¿¡å·

#### 3. é£Žé™©ç®¡ç†
- ä½¿ç”¨ ML æ¨¡åž‹é¢„æµ‹å¸‚åœºé£Žé™©ï¼ˆé«˜æ³¢åŠ¨çŽ‡ã€å´©ç›˜é£Žé™©ï¼‰
- æ ¹æ®é£Žé™©æ°´å¹³è°ƒæ•´ä»“ä½å¤§å°
- åŠ¨æ€è°ƒæ•´æ­¢æŸå’Œæ­¢ç›ˆ

#### 4. ç­–ç•¥é€‰æ‹©
- ä½¿ç”¨ ML è¯†åˆ«æœ€é€‚åˆå½“å‰å¸‚åœºçš„ç­–ç•¥ç±»åž‹
- ä¾‹å¦‚ï¼šè¯†åˆ«å‡º"å‡å€¼å›žå½’"å¸‚åœºï¼Œåˆ‡æ¢åˆ°å‡å€¼å›žå½’ç­–ç•¥
- ä¾‹å¦‚ï¼šè¯†åˆ«å‡º"è¶‹åŠ¿å¸‚åœº"ï¼Œåˆ‡æ¢åˆ°åŠ¨é‡ç­–ç•¥

---

## ðŸ“š Backtrader å®žçŽ°ä»£ç ç¤ºä¾‹

```python
import backtrader as bt
from sklearn.ensemble import RandomForestClassifier
import numpy as np

class MLEnhancedStrategy(bt.Strategy):
    """
    æœºå™¨å­¦ä¹ å¢žå¼ºç­–ç•¥
    
    ä½¿ç”¨ ML æ¨¡åž‹é¢„æµ‹å¸‚åœºçŠ¶æ€ï¼Œå¹¶åŠ¨æ€è°ƒæ•´äº¤æ˜“è¡Œä¸º
    """
    
    params = (
        # ML æ¨¡åž‹å‚æ•°
        ('model_type', 'random_forest'),  # random_forest, svm, xgboost, etc.
        ('use_ml_filter', False),  # æ˜¯å¦ä½¿ç”¨ ML é¢„ç­›é€‰
        
        # äº¤æ˜“å‚æ•°
        ('lookback', 20),
        ('risk_per_trade', 0.02),
    )
    
    def __init__(self):
        super().__init__()
        
        # åˆå§‹åŒ– ML æ¨¡åž‹ï¼ˆå®žé™…é¡¹ç›®ä¸­ä»Žæ–‡ä»¶åŠ è½½ï¼‰
        self.ml_model = RandomForestClassifier(n_estimators=100, random_state=42)
        self.ml_model_fitted = False
        
        # æ•°æ®å¼•ç”¨
        self.dataclose = self.datas[0].close
        self.market_state = 'unknown'  # bull, bear, sideways
        self.ml_signal = 0  # -1 (sell), 0 (hold), 1 (buy)
    
    def next(self):
        # 1. æ›´æ–°å¸‚åœºçŠ¶æ€ï¼ˆç®€åŒ–ç‰ˆï¼‰
        if len(self.dataclose) > self.params.lookback:
            # è®¡ç®—æ”¶ç›ŠçŽ‡
            returns = self.dataclose.get(size=self.params.lookback)
            returns = returns.pct_change()
            avg_return = returns.mean()
            
            # ç®€å•åˆ†ç±»å¸‚åœºçŠ¶æ€
            if avg_return > 0.01:  # ä¸Šæ¶¨è¶…è¿‡ 1%
                self.market_state = 'bull'
            elif avg_return < -0.01:  # ä¸‹è·Œè¶…è¿‡ 1%
                self.market_state = 'bear'
            else:
                self.market_state = 'sideways'
        
        # 2. å¦‚æžœå¯ç”¨äº† ML é¢„ç­›é€‰
        if self.params.use_ml_filter:
            # é¢„æµ‹å½“å‰å¸‚åœºçŠ¶æ€ä¸‹çš„æœ€ä½³ç­–ç•¥
            # è¿™éƒ¨åˆ†éœ€è¦å®žé™…çš„ ML æ¨¡åž‹
            pass
        
        # 3. æ ¹æ®å¸‚åœºçŠ¶æ€å’Œ ML ä¿¡å·å†³å®š
        if self.market_state == 'bull':
            # ç‰›å¸‚ï¼šå¯ä»¥æ¿€è¿›å…¥
            if not self.position:
                self.buy()
        elif self.market_state == 'bear':
            # ç†Šå¸‚ï¼šå¯ä»¥è°¨æ…Ž
            if self.position:
                self.close()  # æˆ–å‡ä»“
        
        # 4. åŠ¨æ€æ­¢æŸå’Œæ­¢ç›ˆï¼ˆç®€åŒ–ç‰ˆï¼‰
        if self.position:
            unrealized_pnl = self.position.pnl
            if unrealized_pnl > 0:  # ç›ˆåˆ©
                self.close()
            elif unrealized_pnl < -0:  # äºæŸ
                self.close()
```

---

## ðŸ“Š æ€»ç»“

### åº”ç”¨åœºæ™¯

1. **æ–‡æ¡£åˆ†ç±»ç³»ç»Ÿ**
   - è‡ªåŠ¨åˆ†ç±»äº¤æ˜“æŠ¥å‘Š
   - æå–å…³é”®ç­–ç•¥å‚æ•°
   - å»ºç«‹ç­–ç•¥çŸ¥è¯†åº“

2. **å¸‚åœºçŠ¶æ€é¢„æµ‹**
   - å®žæ—¶é¢„æµ‹å¸‚åœºçŠ¶æ€ï¼ˆç‰›å¸‚/ç†Šå¸‚/éœ‡è¡å¸‚ï¼‰
   - è‡ªåŠ¨é€‰æ‹©æœ€é€‚åˆçš„ç­–ç•¥ç±»åž‹

3. **æƒ…ç»ªåˆ†æž**
   - åˆ†æžç¤¾äº¤åª’ä½“å’Œæ–°é—»
   - ç”Ÿæˆå¸‚åœºæƒ…ç»ªæŒ‡æ ‡

4. **é£Žé™©é¢„è­¦**
   - é¢„æµ‹å¸‚åœºé£Žé™©äº‹ä»¶
   - æå‰é¢„è­¦å’Œè°ƒæ•´

### æœ‰æ•ˆæ€§åŽŸå› 

1. **æ•°æ®å¤„ç†èƒ½åŠ›**ï¼šML èƒ½å¤„ç†å¤§é‡æ–‡æœ¬å’Œéžç»“æž„åŒ–æ•°æ®
2. **æ¨¡å¼å‘çŽ°**ï¼šèƒ½å‘çŽ°äººç±»æ— æ³•å‘çŽ°çš„å¤æ‚æ¨¡å¼
3. **è‡ªåŠ¨åŒ–**ï¼šå‡å°‘äººå·¥åˆ†æžçš„å·¥ä½œé‡
4. **æŒç»­æ”¹è¿›**ï¼šæ¨¡åž‹å¯ä»¥ä¸æ–­å­¦ä¹ å’Œä¼˜åŒ–
5. **å®¢è§‚æ€§**ï¼šé¿å…æƒ…ç»ªåŒ–äº¤æ˜“å’Œäººä¸ºé”™è¯¯

---

## ðŸ”— å‚è€ƒé“¾æŽ¥

- **åŽŸå§‹æ–‡æ¡£**: `003_Supervised Learning for Document Classification with Scikit-Learn [Quant Start] (1).html`
- **æ•™ç¨‹**: Scikit-Learn å®˜æ–¹æ–‡æ¡£
- **æ•°æ®é›†**: 20 Newsgroups, Reuters ç­‰æ–‡æœ¬åˆ†ç±»æ•°æ®é›†

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2026-02-02
**ç­–ç•¥ç¼–å·**: 002
**ç­–ç•¥ç±»åž‹**: æœºå™¨å­¦ä¹ /NLPï¼ˆè¾…åŠ©æŠ€æœ¯ï¼‰
**çŠ¶æ€**: âœ… é«˜è´¨é‡å®Œæˆ

è™½ç„¶è¿™ä¸æ˜¯ç›´æŽ¥çš„äº¤æ˜“ç­–ç•¥ï¼Œä½†**æœºå™¨å­¦ä¹ æ˜¯é‡åŒ–äº¤æ˜“çš„é‡è¦ç»„æˆéƒ¨åˆ†**ï¼Œå¯ä»¥æ˜¾è‘—æé«˜ç­–ç•¥çš„æœ‰æ•ˆæ€§å’Œè‡ªåŠ¨åŒ–æ°´å¹³ã€‚
