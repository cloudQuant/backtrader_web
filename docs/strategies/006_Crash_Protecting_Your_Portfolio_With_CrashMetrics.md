# ğŸ›¡ï¸ Crash-Protecting Your Portfolio with CrashMetrics Strategy

**ç­–ç•¥ç±»å‹**: é£é™©ç®¡ç† / é£é™©å¯¹å†²
**ç­–ç•¥å­ç±»**: å´©ç›˜ä¿æŠ¤ç­–ç•¥

---

## ğŸ“‹ ç­–ç•¥æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ **CrashMetrics** æ–¹æ³•è¿›è¡ŒæŠ•èµ„ç»„åˆçš„**é£é™©å¯¹å†²å’Œå´©æºƒä¿æŠ¤**ç­–ç•¥ã€‚è¯¥ç­–ç•¥æ—¨åœ¨è¯†åˆ«å’Œé¿å…æ½œåœ¨çš„æç«¯å¸‚åœºå´©æºƒï¼Œä¿æŠ¤æŠ•èµ„ç»„åˆå…å—ç¾éš¾æ€§æŸå¤±ã€‚

### æ ¸å¿ƒæ€æƒ³

1. **å¸‚åœºå´©æºƒè¯†åˆ«**ï¼šä½¿ç”¨ç»Ÿè®¡æ–¹æ³•è¯†åˆ«å¸‚åœºå´©æºƒäº‹ä»¶
2. **å°¾éƒ¨é£é™©åº¦é‡**ï¼šä½¿ç”¨ CrashMetrics åº¦é‡æŠ•èµ„ç»„åˆçš„å°¾éƒ¨é£é™©
3. **é£é™©å¯¹å†²**ï¼šä½¿ç”¨è¡ç”Ÿå“ï¼ˆå¦‚æœŸæƒã€æœŸè´§ï¼‰å¯¹å†²å°¾éƒ¨é£é™©
4. **åŠ¨æ€é£é™©è°ƒæ•´**ï¼šæ ¹æ®å¸‚åœºæ¡ä»¶åŠ¨æ€è°ƒæ•´é£é™©æ•å£
5. **æœ€å¤§å›æ’¤æ§åˆ¶**ï¼šä¸¥æ ¼æ§åˆ¶å’Œå‡å°‘æœ€å¤§å›æ’¤

### ç­–ç•¥ä¼˜åŠ¿

- âœ… **æç«¯é£é™©ä¿æŠ¤**ï¼šå¯ä»¥æœ‰æ•ˆä¿æŠ¤æŠ•èµ„ç»„åˆå…å—æç«¯å¸‚åœºäº‹ä»¶
- âœ… **å°¾éƒ¨é£é™©æ§åˆ¶**ï¼šä½¿ç”¨å…ˆè¿›çš„å°¾éƒ¨é£é™©åº¦é‡ï¼Œæ§åˆ¶å°¾éƒ¨æŸå¤±
- âœ… **åŠ¨æ€é£é™©ç®¡ç†**ï¼šå¯ä»¥æ ¹æ®å¸‚åœºæ¡ä»¶åŠ¨æ€è°ƒæ•´é£é™©
- âœ… **å¯æ“ä½œæ€§**ï¼šCrashMetrics æä¾›äº†å®ç”¨çš„å·¥å…·å’Œæ–¹æ³•
- âœ… **å­¦æœ¯æ”¯æ’‘**ï¼šåŸºäºå°¾éƒ¨é£é™©ç†è®º

---

## ğŸ§  ç­–ç•¥é€»è¾‘

### æ ¸å¿ƒæ­¥éª¤

#### 1. è®¡ç®— CrashMetrics

```python
# ä½¿ç”¨ CrashMetrics åº“è®¡ç®—å°¾éƒ¨é£é™©

import pandas as pd
from crash_metrics import RiskMetrics

# åˆ›å»ºé£é™©åº¦é‡å¯¹è±¡
risk_metrics = RiskMetrics()

# è®¡ç®—å°¾éƒ¨é£é™©æŒ‡æ ‡
def calculate_crash_metrics(returns):
    """
    è®¡ç®— CrashMetrics çš„å°¾éƒ¨é£é™©æŒ‡æ ‡
    
    Args:
        returns: æŠ•èµ„ç»„åˆçš„æ”¶ç›Šç‡æ•°ç»„
    
    Returns:
        dict: å°¾éƒ¨é£é™©æŒ‡æ ‡
    """
    # è®¡ç®—åŸºæœ¬æŒ‡æ ‡
    mean_return = returns.mean()
    std_return = returns.std()
    
    # è®¡ç®— CrashMetrics æŒ‡æ ‡
    tail_mean = risk_metrics.tail_mean(returns)
    tail_std = risk_metrics.tail_std(returns)
    omega = risk_metrics.omega(returns)
    vega = risk_metrics.vega(returns)
    skewness = risk_metrics.skewness(returns)
    kurtosis = risk_metrics.kurtosis(returns)
    
    # è®¡ç®—æç«¯æŸå¤±æŒ‡æ ‡
    max_drawdown = (1 + returns).cummin().min() - 1
    max_drawdown_duration = calculate_drawdown_duration(returns)
    var_95 = returns.quantile(0.05)  # 5% åˆ†ä½æ•°ï¼ˆæœ€å·®çš„ 5% æ”¶ç›Šç‡ï¼‰
    
    return {
        'mean_return': mean_return,
        'std_return': std_return,
        'tail_mean': tail_mean,
        'tail_std': tail_std,
        'omega': omega,
        'vega': vega,
        'skewness': skewness,
        'kurtosis': kurtosis,
        'max_drawdown': max_drawdown,
        'var_95': var_95,
    }

def calculate_drawdown_duration(returns):
    """
    è®¡ç®—æœ€å¤§å›æ’¤æŒç»­æ—¶é—´
    """
    # è®¡ç®—ç´¯ç§¯æ”¶ç›Š
    cumulative_returns = (1 + returns).cumprod()
    
    # è®¡ç®—å›æ’¤
    rolling_max = cumulative_returns.cummax()
    drawdown = (cumulative_returns / rolling_max) - 1
    
    # è®¡ç®—å›æ’¤æŒç»­æ—¶é—´
    drawdown_duration = 0
    max_duration = 0
    
    for dd in drawdown:
        if dd < 0:
            drawdown_duration += 1
            if drawdown_duration > max_duration:
                max_duration = drawdown_duration
        else:
            drawdown_duration = 0
    
    return max_duration
```

#### 2. è¯†åˆ«å¸‚åœºå´©æºƒ

```python
# è¯†åˆ«å¸‚åœºå´©æºƒäº‹ä»¶

def identify_crash_events(returns, crash_threshold=-0.1):
    """
    è¯†åˆ«å¸‚åœºå´©æºƒäº‹ä»¶
    
    Args:
        returns: å¸‚åœºæ”¶ç›Šç‡æ•°ç»„
        crash_threshold: å´©æºƒé˜ˆå€¼ï¼ˆå¦‚å•æ—¥ä¸‹è·Œè¶…è¿‡ 10%ï¼‰
    
    Returns:
        list: å´©æºƒäº‹ä»¶åˆ—è¡¨ï¼ˆæ—¥æœŸå’Œè·Œå¹…ï¼‰
    """
    # è¯†åˆ«å´©æºƒæ—¥
    crash_days = returns[returns < crash_threshold].index.tolist()
    
    # åˆ›å»ºå´©æºƒäº‹ä»¶åˆ—è¡¨
    crash_events = []
    for date in crash_days:
        crash_events.append({
            'date': date,
            'return': returns.loc[date],
            'severity': abs(returns.loc[date]),
        })
    
    return sorted(crash_events, key=lambda x: x['return'])
```

#### 3. æ„å»ºé£é™©å¯¹å†²ç»„åˆ

```python
# æ„å»ºé£é™©å¯¹å†²ç»„åˆ

def build_hedge_portfolio(main_portfolio, crash_metrics):
    """
    æ„å»ºé£é™©å¯¹å†²ç»„åˆ
    
    Args:
        main_portfolio: ä¸»æŠ•èµ„ç»„åˆï¼ˆè‚¡ç¥¨ï¼‰
        crash_metrics: å°¾éƒ¨é£é™©åº¦é‡
    
    Returns:
        dict: å¯¹å†²ç»„åˆé…ç½®
    """
    # è®¡ç®—å°¾éƒ¨é£é™©æš´éœ²
    tail_risk_exposure = crash_metrics['omega']  # Omega æŒ‡æ ‡
    
    # å¯¹å†²ç­–ç•¥
    if tail_risk_exposure > 2.0:  # é«˜å°¾éƒ¨é£é™©
        hedge_ratio = 0.20  # 20% å¯¹å†²æ¯”ä¾‹
        hedge_asset = 'PUT_OPTIONS'  # ä½¿ç”¨çœ‹è·ŒæœŸæƒå¯¹å†²
    elif tail_risk_exposure > 1.5:  # ä¸­ç­‰å°¾éƒ¨é£é™©
        hedge_ratio = 0.10  # 10% å¯¹å†²æ¯”ä¾‹
        hedge_asset = 'VIX_FUTURES'  # ä½¿ç”¨ VIX æœŸè´§å¯¹å†²
    else:  # ä½å°¾éƒ¨é£é™©
        hedge_ratio = 0.05  # 5% å¯¹å†²æ¯”ä¾‹
        hedge_asset = 'CASH'  # ç°é‡‘å¯¹å†²
    
    return {
        'hedge_ratio': hedge_ratio,
        'hedge_asset': hedge_asset,
        'tail_risk_exposure': tail_risk_exposure,
    }
```

#### 4. åŠ¨æ€é£é™©è°ƒæ•´

```python
# åŠ¨æ€è°ƒæ•´é£é™©æ•å£

def adjust_risk_exposure(current_exposure, crash_metrics, market_conditions):
    """
    åŠ¨æ€è°ƒæ•´é£é™©æ•å£
    
    Args:
        current_exposure: å½“å‰é£é™©æ•å£
        crash_metrics: å°¾éƒ¨é£é™©åº¦é‡
        market_conditions: å¸‚åœºæ¡ä»¶ï¼ˆå¦‚ VIXã€æ³¢åŠ¨ç‡ï¼‰
    
    Returns:
        dict: è°ƒæ•´åçš„é£é™©æ•å£
    """
    # è®¡ç®— VIX æ°´å¹³
    vix_level = market_conditions.get('vix', 15.0)
    
    # è®¡ç®— VIX è°ƒæ•´å› å­
    if vix_level > 30.0:  # é«˜æ³¢åŠ¨ç‡
        vix_adjustment = 0.5  # å‡å°‘é£é™©æ•å£ 50%
    elif vix_level > 20.0:  # ä¸­é«˜æ³¢åŠ¨ç‡
        vix_adjustment = 0.75  # å‡å°‘é£é™©æ•å£ 25%
    elif vix_level < 12.0:  # ä½æ³¢åŠ¨ç‡
        vix_adjustment = 1.25  # å¢åŠ é£é™©æ•å£ 25%
    else:  # æ­£å¸¸æ³¢åŠ¨ç‡
        vix_adjustment = 1.0  # ä¸è°ƒæ•´
    
    # è®¡ç®—å°¾éƒ¨é£é™©è°ƒæ•´å› å­
    tail_risk_exposure = crash_metrics['omega']
    if tail_risk_exposure > 2.0:
        tail_risk_adjustment = 0.8  # å‡å°‘é£é™©æ•å£ 20%
    elif tail_risk_exposure > 1.5:
        tail_risk_adjustment = 0.9  # å‡å°‘é£é™©æ•å£ 10%
    else:
        tail_risk_adjustment = 1.0  # ä¸è°ƒæ•´
    
    # è®¡ç®—æ€»è°ƒæ•´å› å­
    total_adjustment = vix_adjustment * tail_risk_adjustment
    
    # è®¡ç®—è°ƒæ•´åçš„é£é™©æ•å£
    adjusted_exposure = current_exposure * total_adjustment
    
    return {
        'current_exposure': current_exposure,
        'adjusted_exposure': adjusted_exposure,
        'vix_level': vix_level,
        'vix_adjustment': vix_adjustment,
        'tail_risk_exposure': tail_risk_exposure,
        'tail_risk_adjustment': tail_risk_adjustment,
    }
```

---

## ğŸ“Š éœ€è¦çš„æ•°æ®

### 1. æŠ•èµ„ç»„åˆæ•°æ®ï¼ˆå¿…éœ€ï¼‰

#### æ”¶ç›Šç‡æ•°æ®
- **æŠ•èµ„ç»„åˆå‡€å€¼**: æŠ•èµ„ç»„åˆçš„æ¯æ—¥å‡€å€¼
- **è‚¡ç¥¨ä»·æ ¼æ•°æ®**: æŠ•èµ„ç»„åˆä¸­æ‰€æœ‰è‚¡ç¥¨çš„ä»·æ ¼æ•°æ®
- **è®¡ç®—é¢‘ç‡**: æ—¥æ•°æ®æˆ–æ—¥å†…æ•°æ®
- **æ—¶é—´èŒƒå›´**: è‡³å°‘ 5-10 å¹´çš„å†å²æ•°æ®

#### æƒé‡æ•°æ®
- **è‚¡ç¥¨æƒé‡**: æ¯ä¸ªè‚¡ç¥¨åœ¨æŠ•èµ„ç»„åˆä¸­çš„æƒé‡
- **è¡Œä¸šæƒé‡**: æ¯ä¸ªè¡Œä¸šçš„æƒé‡
- **åœ°åŒºæƒé‡**: æ¯ä¸ªåœ°åŒºçš„æƒé‡
- **èµ„äº§ç±»åˆ«æƒé‡**: æ¯ä¸ªèµ„äº§ç±»åˆ«çš„æƒé‡

### 2. å¸‚åœºæ•°æ®ï¼ˆå¿…éœ€ï¼‰

#### æ³¢åŠ¨ç‡æ•°æ®
- **VIX æŒ‡æ•°**: èŠåŠ å“¥æœŸæƒäº¤æ˜“æ‰€æ³¢åŠ¨ç‡æŒ‡æ•°
- **VIX æœŸè´§**: VIX æœŸè´§çš„å®æ—¶å’Œå†å²æ•°æ®
- **æ³¢åŠ¨ç‡æœŸé™ç»“æ„**: ä¸åŒåˆ°æœŸæœˆä»½çš„ VIX æœŸè´§ä»·æ ¼
- **éšå«æ³¢åŠ¨ç‡**: ä¸åŒè¡Œæƒä»·å’Œåˆ°æœŸæ—¥çš„éšå«æ³¢åŠ¨ç‡

#### é£é™©æŒ‡æ ‡æ•°æ®
- **æœŸæƒæ•°æ®**: æ ‡æ™® 500 æœŸæƒçš„ä»·æ ¼å’Œéšå«æ³¢åŠ¨ç‡
- **æœŸæƒé“¾æ•°æ®**: ä¸åŒåˆ°æœŸæ—¥å’Œè¡Œæƒä»·çš„æœŸæƒé“¾
- **åæ–œåº¦æ•°æ®**: æœŸæƒåæ–œåº¦çš„åº¦é‡
- **æœŸé™ç»“æ„æ•°æ®**: æœŸæƒæœŸé™ç»“æ„çš„æ•°æ®

### 3. å®è§‚ç»æµæ•°æ®ï¼ˆæ¨èï¼‰

#### ç»æµæŒ‡æ ‡
- **GDP æ•°æ®**: å›½å†…ç”Ÿäº§æ€»å€¼å¢é•¿ç‡
- **é€šèƒ€ç‡**: CPI æˆ– PPI é€šèƒ€ç‡
- **å¤±ä¸šç‡**: å¤±ä¸šç‡æ•°æ®
- **åˆ©ç‡æ•°æ®**: è”é‚¦åŸºé‡‘åˆ©ç‡ã€LIBOR

#### å¸‚åœºæƒ…ç»ªæ•°æ®
- **VIX æœŸè´§æŒä»“é‡**: VIX æœŸè´§çš„æŒä»“é‡å’Œæˆäº¤é‡
- **COT æŠ¥å‘Š**: å•†å“æœŸè´§äº¤æ˜“å§”å‘˜ä¼šæŠ¥å‘Š
- **Put/Call Ratio**: çœ‹è·ŒæœŸæƒä¸çœ‹æ¶¨æœŸæƒçš„æ¯”ä¾‹
- **æœŸæƒæ³¢åŠ¨ç‡**: æœŸæƒéšå«æ³¢åŠ¨ç‡

---

## âœ… ç­–ç•¥æœ‰æ•ˆæ€§åŸå› 

### ä¸ºä»€ä¹ˆè¯¥ç­–ç•¥å¯èƒ½æœ‰æ•ˆï¼Ÿ

#### 1. å°¾éƒ¨é£é™©ç†è®º
- **Fat-Tail åˆ†å¸ƒ**: é‡‘èå¸‚åœºæ”¶ç›Šç‡åˆ†å¸ƒå­˜åœ¨è‚¥å°¾ç‰¹å¾ï¼Œæç«¯äº‹ä»¶å‘ç”Ÿçš„é¢‘ç‡é«˜äºæ­£æ€åˆ†å¸ƒ
- **æå€¼ç†è®º**: æ ¹æ® Fisher-Tippet æå€¼ç†è®ºï¼Œæœ€å¤§æŸå¤±ä¼šéšç€æ ·æœ¬é‡å¢åŠ è€Œå¢åŠ 
- **å°¾éƒ¨é£é™©åº¦é‡**: ä½¿ç”¨ Omegaã€VaRã€CVaR ç­‰æŒ‡æ ‡å¯ä»¥å‡†ç¡®åº¦é‡å°¾éƒ¨é£é™©

#### 2. é£é™©å¯¹å†²ä»·å€¼
- **å¯¹å†²å°¾éƒ¨é£é™©**: ä½¿ç”¨çœ‹è·ŒæœŸæƒæˆ–åšç©ºæœŸè´§å¯ä»¥æœ‰æ•ˆå¯¹å†²å°¾éƒ¨é£é™©
- **éçº¿æ€§æ”¶ç›Š**: æœŸæƒæä¾›éçº¿æ€§çš„æ”¶ç›Šç‰¹å¾ï¼Œå¯ä»¥åœ¨å¸‚åœºä¸‹è·Œæ—¶æä¾›ä¿æŠ¤
- **æˆæœ¬æ•ˆç›Š**: ä¸ç›´æ¥å–å‡ºè‚¡ç¥¨ç›¸æ¯”ï¼Œä½¿ç”¨æœŸæƒå¯¹å†²é€šå¸¸æ›´å…·æˆæœ¬æ•ˆç›Š

#### 3. åŠ¨æ€é£é™©ç®¡ç†
- **é€‚åº”æ€§è°ƒæ•´**: æ ¹æ®å¸‚åœºæ¡ä»¶åŠ¨æ€è°ƒæ•´é£é™©æ•å£å¯ä»¥æé«˜é£é™©è°ƒæ•´æ•ˆç‡
- **å®æ—¶ç›‘æ§**: å®æ—¶ç›‘æ§å¸‚åœºæ³¢åŠ¨ç‡å’Œå°¾éƒ¨é£é™©å¯ä»¥åŠæ—¶è°ƒæ•´é£é™©ç­–ç•¥
- **æƒ…æ™¯åˆ†æ**: è€ƒè™‘ä¸åŒçš„å¸‚åœºæƒ…æ™¯ï¼ˆç‰›å¸‚ã€ç†Šå¸‚ã€é«˜æ³¢åŠ¨ç‡ã€ä½æ³¢åŠ¨ç‡ï¼‰

#### 4. å´©ç›˜ä¿æŠ¤
- **å‡å°‘æœ€å¤§å›æ’¤**: ä¸¥æ ¼çš„é£é™©æ§åˆ¶å¯ä»¥æ˜¾è‘—å‡å°‘æœ€å¤§å›æ’¤
- **ä¿æŠ¤èµ„æœ¬**: åœ¨å¸‚åœºå´©æºƒæ—¶ä¿æŠ¤èµ„æœ¬æ˜¯é•¿æœŸæˆåŠŸçš„å…³é”®
- **å¿ƒç†ä¼˜åŠ¿**: æœ‰æ•ˆçš„å´©æºƒä¿æŠ¤å¯ä»¥æä¾›å¿ƒç†å®‰å…¨æ„Ÿï¼Œé¿å…æƒ…ç»ªåŒ–å†³ç­–

#### 5. å­¦æœ¯æ”¯æ’‘
- **RiskMetrics ç ”ç©¶**: RiskMetrics (1994) æä¾›äº†ç»Ÿä¸€çš„æ¡†æ¶æ¥åº¦é‡é£é™©
- **å°¾éƒ¨é£é™©ç ”ç©¶**: Artzner, Embrechts, Delbaen (1999) æå‡ºäº† Coherent Risk Measuresï¼ˆä¸€è‡´æ€§é£é™©åº¦é‡ï¼‰
- **CrashMetrics æ–‡çŒ®**: æœ‰å¤§é‡å…³äºå¸‚åœºå´©æºƒå’Œå°¾éƒ¨é£é™©çš„å­¦æœ¯ç ”ç©¶

---

## âš ï¸ é£é™©å’Œæ³¨æ„äº‹é¡¹

### ä¸»è¦é£é™©

#### 1. å¯¹å†²é£é™©
- **å¯¹å†²æˆæœ¬**: æœŸæƒå’ŒæœŸè´§ç­‰å¯¹å†²å·¥å…·çš„æˆæœ¬ï¼ˆæœŸæƒè´¹ã€ç‚¹å·®ï¼‰ä¼šä¾µèš€æ”¶ç›Š
- **åŸºå·®é£é™©**: æœŸè´§ä»·æ ¼ä¸ç°è´§ä»·æ ¼ä¹‹é—´çš„åŸºå·®é£é™©
- **æ—¶é—´è¡°å‡**: æœŸæƒçš„æ—¶é—´ä»·å€¼è¡°å‡å¯¹å¤šå¤´å¤´å¯¸ä¸åˆ©
- **æ‰§è¡Œé£é™©**: å¯¹å†²äº¤æ˜“å¯èƒ½æ— æ³•åŠæ—¶æˆ–ä»¥é¢„æœŸä»·æ ¼æ‰§è¡Œ

#### 2. æ¨¡å‹é£é™©
- **å‚æ•°æ•æ„Ÿæ€§**: CrashMetrics æŒ‡æ ‡å¯¹å‚æ•°è®¾ç½®å¯èƒ½æ¯”è¾ƒæ•æ„Ÿ
- **ä¼°è®¡è¯¯å·®**: å°¾éƒ¨é£é™©çš„ä¼°è®¡å­˜åœ¨ä¸ç¡®å®šæ€§
- **æ¨¡å‹å‡è®¾**: RiskMetrics åŸºäºæŸäº›å‡è®¾ï¼ˆå¦‚æ”¶ç›Šç‡åˆ†å¸ƒï¼‰ï¼Œè¿™äº›å‡è®¾å¯èƒ½ä¸å®Œå…¨æˆç«‹
- **è¿‡æ‹Ÿåˆ**: å¦‚æœä½¿ç”¨å†å²æ•°æ®ä¼˜åŒ–å‚æ•°ï¼Œå¯èƒ½è¿‡æ‹Ÿåˆ

#### 3. å¸‚åœºé£é™©
- **æç«¯äº‹ä»¶**: æç«¯å¸‚åœºäº‹ä»¶ï¼ˆå¦‚é‡‘èå±æœºï¼‰å¯èƒ½å¯¼è‡´å¯¹å†²å¤±æ•ˆ
- **æµåŠ¨æ€§å±æœº**: åœ¨æµåŠ¨æ€§å±æœºæ—¶ï¼Œå¯¹å†²å·¥å…·å¯èƒ½æ— æ³•æœ‰æ•ˆå¯¹å†²
- **ç›¸å…³æ€§å˜åŒ–**: å¸‚åœºç›¸å…³æ€§åœ¨æç«¯æƒ…å†µä¸‹å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼Œå½±å“å¯¹å†²æ•ˆæœ

#### 4. æ‰§è¡Œé£é™©
- **å»¶è¿Ÿé£é™©**: å¯¹å†²ä¿¡å·çš„å»¶è¿Ÿå¯èƒ½å¯¼è‡´é”™è¿‡æœ€ä½³å¯¹å†²æ—¶æœº
- **æ»‘ç‚¹é£é™©**: åœ¨é«˜æ³¢åŠ¨å¸‚åœºä¸­ï¼Œå¯¹å†²äº¤æ˜“çš„æ»‘ç‚¹å¯èƒ½è¾ƒå¤§
- **æˆäº¤é£é™©**: å¯¹å†²å·¥å…·å¯èƒ½æ— æ³•ä»¥é¢„æœŸä»·æ ¼æˆäº¤
- **æµåŠ¨æ€§é£é™©**: æŸäº›å¯¹å†²å·¥å…·ï¼ˆå¦‚æ·±åº¦è™šå€¼æœŸæƒï¼‰çš„æµåŠ¨æ€§å¯èƒ½ä¸è¶³

#### 5. åˆè§„é£é™©
- **æœŸæƒäº¤æ˜“ç›‘ç®¡**: æœŸæƒäº¤æ˜“å—åˆ°ä¸¥æ ¼ç›‘ç®¡ï¼Œéœ€è¦äº†è§£ç›¸å…³è§„å®š
- **ä¿è¯é‡‘è¦æ±‚**: æœŸæƒäº¤æ˜“éœ€è¦ä¿è¯é‡‘ï¼Œéœ€è¦æ»¡è¶³ä¿è¯é‡‘è¦æ±‚
- **é£é™©æŠ«éœ²**: éœ€è¦å‘ç›‘ç®¡æœºæ„æŠ«éœ²é£é™©æŒ‡æ ‡å’Œé£é™©ç®¡ç†æªæ–½

---

## ğŸ§ª å®æ–½æ­¥éª¤

### 1. é£é™©åº¦é‡ç³»ç»Ÿå¼€å‘

#### æ­¥éª¤ 1ï¼šå®ç° CrashMetrics
- **å®‰è£…ä¾èµ–**: å®‰è£… crash_metrics åº“å’Œç›¸å…³ä¾èµ–
- **å®ç°æŒ‡æ ‡**: å®ç°æ‰€æœ‰å°¾éƒ¨é£é™©æŒ‡æ ‡ï¼ˆOmega, Vega, Tail Mean ç­‰ï¼‰
- **æ•°æ®æ¥å£**: åˆ›å»ºä¸å¸‚åœºæ•°æ®æä¾›å•†çš„æ¥å£
- **å®æ—¶è®¡ç®—**: å®ç°å®æ—¶è®¡ç®—å°¾éƒ¨é£é™©æŒ‡æ ‡

#### æ­¥éª¤ 2ï¼šé£é™©ç›‘æ§ç³»ç»Ÿ
- **å®æ—¶ç›‘æ§**: å®æ—¶ç›‘æ§æŠ•èµ„ç»„åˆçš„å°¾éƒ¨é£é™©
- **é£é™©é˜ˆå€¼**: è®¾ç½®é£é™©é˜ˆå€¼ï¼Œè¶…è¿‡é˜ˆå€¼æ—¶è§¦å‘è­¦æŠ¥
- **é£é™©æŠ¥å‘Š**: ç”Ÿæˆé£é™©æŠ¥å‘Šï¼ŒåŒ…æ‹¬å†å²å’Œå®æ—¶æ•°æ®
- **é£é™©ä»ªè¡¨æ¿**: åˆ›å»ºé£é™©ä»ªè¡¨æ¿ï¼Œå¯è§†åŒ–é£é™©æŒ‡æ ‡

### 2. å¯¹å†²ç³»ç»Ÿå¼€å‘

#### æ­¥éª¤ 3ï¼šå¯¹å†²å·¥å…·é€‰æ‹©
- **æœŸæƒç­–ç•¥**: é€‰æ‹©åˆé€‚çš„æœŸæƒç­–ç•¥ï¼ˆå¦‚ä¹°å…¥çœ‹è·ŒæœŸæƒã€å®½è·¨å¼æœŸæƒï¼‰
- **æœŸè´§ç­–ç•¥**: é€‰æ‹©åˆé€‚çš„æœŸè´§ç­–ç•¥ï¼ˆå¦‚åšç©ºè‚¡æŒ‡æœŸè´§ï¼‰
- **æ··åˆç­–ç•¥**: ç»“åˆæœŸæƒå’ŒæœŸè´§çš„æ··åˆç­–ç•¥
- **åŠ¨æ€å¯¹å†²**: å®ç°åŠ¨æ€å¯¹å†²ï¼Œæ ¹æ®é£é™©æŒ‡æ ‡è°ƒæ•´å¯¹å†²æ¯”ä¾‹

#### æ­¥éª¤ 4ï¼šå¯¹å†²æ‰§è¡Œ
- **è‡ªåŠ¨æ‰§è¡Œ**: å®ç°è‡ªåŠ¨å¯¹å†²æ‰§è¡Œç³»ç»Ÿ
- **æˆæœ¬ä¼˜åŒ–**: ä¼˜åŒ–å¯¹å†²äº¤æ˜“çš„æˆæœ¬
- **æµåŠ¨æ€§ç®¡ç†**: ç®¡ç†å¯¹å†²å·¥å…·çš„æµåŠ¨æ€§
- **äº¤æ˜“æ—¶æœº**: ä¼˜åŒ–å¯¹å†²äº¤æ˜“çš„æ—¶æœºï¼Œå‡å°‘æˆæœ¬

### 3. é£é™©ç®¡ç†ç³»ç»Ÿå¼€å‘

#### æ­¥éª¤ 5ï¼šé£é™©é¢„ç®—
- **VaR è®¡ç®—**: è®¡ç®—é£é™©ä»·å€¼
- **CVaR è®¡ç®—**: è®¡ç®—æ¡ä»¶é£é™©ä»·å€¼
- **å°¾éƒ¨é£é™©é¢„ç®—**: è®¾ç½®å°¾éƒ¨é£é™©é¢„ç®—
- **é£é™©é™é¢**: è®¾ç½®é£é™©é™é¢ï¼ˆå•ç¬”äº¤æ˜“ã€æ€»é£é™©ï¼‰
- **å‹åŠ›æµ‹è¯•**: å®šæœŸè¿›è¡Œå‹åŠ›æµ‹è¯•

#### æ­¥éª¤ 6ï¼šé£é™©æ§åˆ¶æœºåˆ¶
- **æ­¢æŸæœºåˆ¶**: è®¾ç½®æ­¢æŸæœºåˆ¶ï¼Œæ§åˆ¶æŸå¤±
- **ä»“ä½é™åˆ¶**: è®¾ç½®ä»“ä½é™åˆ¶ï¼Œæ§åˆ¶é£é™©æ•å£
- **åˆ†æ•£åŒ–**: ç¡®ä¿æŠ•èµ„ç»„åˆå……åˆ†åˆ†æ•£åŒ–
- **å¯¹å†²æ¯”ä¾‹**: æ ¹æ®é£é™©æ°´å¹³è°ƒæ•´å¯¹å†²æ¯”ä¾‹

### 4. å›æµ‹å’ŒéªŒè¯

#### æ­¥éª¤ 7ï¼šå†å²å›æµ‹
- **é•¿æœŸå›æµ‹**: ä½¿ç”¨ 10-20 å¹´å†å²æ•°æ®è¿›è¡Œå›æµ‹
- **æç«¯äº‹ä»¶åˆ†æ**: åˆ†æç­–ç•¥åœ¨æç«¯å¸‚åœºäº‹ä»¶ä¸­çš„è¡¨ç°
- **å´©æºƒæœŸåˆ†æ**: åˆ†æç­–ç•¥åœ¨å†å²å´©æºƒæœŸä¸­çš„è¡¨ç°
- **å‹åŠ›æµ‹è¯•**: è¿›è¡Œå‹åŠ›æµ‹è¯•ï¼Œæ¨¡æ‹Ÿæç«¯å¸‚åœºæ¡ä»¶

#### æ­¥éª¤ 8ï¼šæ ·æœ¬å¤–æµ‹è¯•
- **æ ·æœ¬å¤–æµ‹è¯•**: åœ¨ä¸åŒçš„æ—¶é—´æ®µè¿›è¡Œæ ·æœ¬å¤–æµ‹è¯•
- **å­å‘¨æœŸæµ‹è¯•**: åœ¨ä¸åŒçš„å­å‘¨æœŸï¼ˆç‰›å¸‚ã€ç†Šå¸‚ï¼‰ä¸­æµ‹è¯•
- **ç¨³å®šæ€§åˆ†æ**: åˆ†æç­–ç•¥åœ¨ä¸åŒå¸‚åœºæ¡ä»¶ä¸‹çš„ç¨³å®šæ€§
- **é²æ£’æ€§æµ‹è¯•**: æµ‹è¯•ç­–ç•¥å¯¹å‚æ•°å˜åŒ–çš„é²æ£’æ€§

---

## âš™ï¸ å‚æ•°é…ç½®

### æ ¸å¿ƒå‚æ•°

```python
# CrashMetrics é£é™©ç®¡ç†ç­–ç•¥å‚æ•°

params = (
    # å°¾éƒ¨é£é™©å‚æ•°
    ('tail_mean_period', 60),       # Tail Mean è®¡ç®—å‘¨æœŸï¼ˆäº¤æ˜“æ—¥ï¼‰
    ('tail_std_period', 60),        # Tail Std è®¡ç®—å‘¨æœŸï¼ˆäº¤æ˜“æ—¥ï¼‰
    ('omega_threshold', 2.0),      # Omega é˜ˆå€¼ï¼ˆé«˜å°¾éƒ¨é£é™©ï¼‰
    ('var_95_quantile', 0.05),     # 95% VaR åˆ†ä½æ•°ï¼ˆ5% åˆ†ä½æ•°ï¼‰
    
    # å´©æºƒè¯†åˆ«å‚æ•°
    ('crash_threshold', -0.10),   # å´©æºƒé˜ˆå€¼ï¼ˆå•æ—¥è·Œå¹…ï¼‰
    ('crash_window', 5),           # å´©æºƒè¯†åˆ«çª—å£ï¼ˆäº¤æ˜“æ—¥ï¼‰
    
    # å¯¹å†²å‚æ•°
    ('high_tail_hedge_ratio', 0.20),  # é«˜å°¾éƒ¨é£é™©å¯¹å†²æ¯”ä¾‹
    ('medium_tail_hedge_ratio', 0.10),  # ä¸­ç­‰å°¾éƒ¨é£é™©å¯¹å†²æ¯”ä¾‹
    ('low_tail_hedge_ratio', 0.05),    # ä½å°¾éƒ¨é£é™©å¯¹å†²æ¯”ä¾‹
    ('hedge_asset', 'PUT_OPTIONS'),   # å¯¹å†²èµ„äº§ç±»å‹
    
    # åŠ¨æ€è°ƒæ•´å‚æ•°
    ('vix_high_threshold', 30.0),   # é«˜ VIX é˜ˆå€¼
    ('vix_medium_threshold', 20.0),  # ä¸­ç­‰ VIX é˜ˆå€¼
    ('vix_low_threshold', 12.0),     # ä½ VIX é˜ˆå€¼
    ('vix_adjustment_factor', 0.5),  # VIX è°ƒæ•´å› å­
    
    # é£é™©æ§åˆ¶å‚æ•°
    ('max_exposure', 1.0),           # æœ€å¤§é£é™©æ•å£ï¼ˆå æŠ•èµ„ç»„åˆæ¯”ä¾‹ï¼‰
    ('max_drawdown_limit', 0.20),    # æœ€å¤§å›æ’¤é™åˆ¶
    ('var_limit', 0.05),             # æœ€å¤§ 95% VaRï¼ˆæŠ•èµ„ç»„åˆå‡€å€¼çš„ 5%ï¼‰
    ('tail_risk_limit', 2.0),        # æœ€å¤§å°¾éƒ¨é£é™©ï¼ˆOmega æŒ‡æ ‡ï¼‰
    
    # æ­¢æŸæ­¢ç›ˆå‚æ•°
    ('stop_loss', 0.10),              # æ­¢æŸæ¯”ä¾‹ï¼ˆä»å…¥åœºä»·æ ¼ä¸‹è·Œ 10%ï¼‰
    ('take_profit', 0.05),            # æ­¢ç›ˆæ¯”ä¾‹ï¼ˆä»å…¥åœºä»·æ ¼ä¸Šæ¶¨ 5%ï¼‰
    ('trailing_stop', 0.05),           # è·Ÿè¸ªæ­¢æŸï¼ˆä»æœ€é«˜ç‚¹ä¸‹è·Œ 5%ï¼‰
)
```

### å‚æ•°è¯´æ˜

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ | ä¼˜åŒ–å»ºè®® |
|------|--------|------|----------|
| tail_mean_period | 60 | Tail Mean è®¡ç®—å‘¨æœŸ | 30, 60, 90 |
| omega_threshold | 2.0 | Omega é˜ˆå€¼ | 1.5, 2.0, 2.5 |
| crash_threshold | -0.10 | å´©æºƒé˜ˆå€¼ | -0.05, -0.10, -0.15 |
| high_tail_hedge_ratio | 0.20 | é«˜å°¾éƒ¨é£é™©å¯¹å†²æ¯”ä¾‹ | 0.10, 0.20, 0.30 |
| max_exposure | 1.0 | æœ€å¤§é£é™©æ•å£ | 0.5, 0.75, 1.0 |
| max_drawdown_limit | 0.20 | æœ€å¤§å›æ’¤é™åˆ¶ | 0.10, 0.15, 0.20 |

---

## ğŸ§© Backtrader å®ç°æ¡†æ¶

```python
import backtrader as bt
import backtrader.indicators as btind
import numpy as np
from crash_metrics import RiskMetrics

class CrashMetricsHedgeStrategy(bt.Strategy):
    """
    CrashMetrics é£é™©ç®¡ç†ç­–ç•¥
    
    ä½¿ç”¨ CrashMetrics åº¦é‡å°¾éƒ¨é£é™©ï¼Œå¹¶æ ¹æ®é£é™©æ°´å¹³åŠ¨æ€å¯¹å†²
    """
    
    params = (
        # å°¾éƒ¨é£é™©å‚æ•°
        ('tail_mean_period', 60),
        ('tail_std_period', 60),
        ('omega_threshold', 2.0),
        ('var_95_quantile', 0.05),
        
        # å´©æºƒè¯†åˆ«å‚æ•°
        ('crash_threshold', -0.10),
        ('crash_window', 5),
        
        # å¯¹å†²å‚æ•°
        ('high_tail_hedge_ratio', 0.20),
        ('medium_tail_hedge_ratio', 0.10),
        ('low_tail_hedge_ratio', 0.05),
        ('hedge_asset', 'PUT_OPTIONS'),
        
        # é£é™©æ§åˆ¶å‚æ•°
        ('max_exposure', 1.0),
        ('max_drawdown_limit', 0.20),
        ('var_limit', 0.05),
        ('tail_risk_limit', 2.0),
        
        # æ­¢æŸæ­¢ç›ˆå‚æ•°
        ('stop_loss', 0.10),
        ('take_profit', 0.05),
        ('trailing_stop', 0.05),
    )
    
    def __init__(self):
        super().__init__()
        
        # æ•°æ®å¼•ç”¨
        self.dataclose = self.datas[0].close
        self.datavolume = self.datas[0].volume
        
        # CrashMetrics
        self.risk_metrics = RiskMetrics()
        
        # æŒ‡æ ‡
        self.tail_mean = None
        self.tail_std = None
        self.omega = None
        self.var_95 = None
        
        # é£é™©æ°´å¹³
        self.tail_risk_level = "normal"  # normal, high, extreme
        self.risk_exposure = 1.0
        
        # å¯¹å†²å¤´å¯¸
        self.hedge_position = None
        
        # è®¢å•
        self.order = None
        
        print(f"{self.__class__.__name__} åˆå§‹åŒ–å®Œæˆ")
    
    def next(self):
        """
        æ ¸å¿ƒç­–ç•¥é€»è¾‘
        """
        # ç¡®ä¿æœ‰è¶³å¤Ÿæ•°æ®
        if len(self.dataclose) < self.params.tail_mean_period:
            return
        
        # è®¡ç®— CrashMetrics
        self.calculate_crash_metrics()
        
        # åˆ†æé£é™©æ°´å¹³
        self.analyze_tail_risk()
        
        # ç”Ÿæˆå¯¹å†²ä¿¡å·
        hedge_signal = self.generate_hedge_signal()
        
        # æ‰§è¡Œå¯¹å†²äº¤æ˜“
        self.execute_hedge(hedge_signal)
    
    def calculate_crash_metrics(self):
        """
        è®¡ç®— CrashMetrics å°¾éƒ¨é£é™©æŒ‡æ ‡
        """
        # è®¡ç®—å°¾éƒ¨æ”¶ç›Š
        tail_returns = self.dataclose.get(size=self.params.tail_mean_period).pct_change().dropna()
        
        # è®¡ç®—æŒ‡æ ‡
        self.tail_mean = self.risk_metrics.tail_mean(tail_returns)
        self.tail_std = self.risk_metrics.tail_std(tail_returns)
        self.omega = self.risk_metrics.omega(tail_returns)
        self.var_95 = self.risk_metrics.value_at_risk(tail_returns, self.params.var_95_quantile)
    
    def analyze_tail_risk(self):
        """
        åˆ†æå°¾éƒ¨é£é™©æ°´å¹³
        """
        # åˆ¤æ–­å°¾éƒ¨é£é™©æ°´å¹³
        if self.omega > self.params.omega_threshold:
            self.tail_risk_level = "extreme"  # æç«¯å°¾éƒ¨é£é™©
            self.risk_exposure = 0.5  # å‡å°‘é£é™©æ•å£
        elif self.omega > self.params.omega_threshold * 0.75:
            self.tail_risk_level = "high"  # é«˜å°¾éƒ¨é£é™©
            self.risk_exposure = 0.75  # ç•¥å¾®å‡å°‘é£é™©æ•å£
        else:
            self.tail_risk_level = "normal"  # æ­£å¸¸å°¾éƒ¨é£é™©
            self.risk_exposure = 1.0  # æ­£å¸¸é£é™©æ•å£
        
        print(f"å°¾éƒ¨é£é™©æ°´å¹³: {self.tail_risk_level}, Omega: {self.omega:.2f}, é£é™©æ•å£: {self.risk_exposure}")
    
    def generate_hedge_signal(self):
        """
        ç”Ÿæˆå¯¹å†²ä¿¡å·
        """
        # æ ¹æ®å°¾éƒ¨é£é™©æ°´å¹³ç”Ÿæˆå¯¹å†²ä¿¡å·
        if self.tail_risk_level == "extreme":
            # æç«¯å°¾éƒ¨é£é™©ï¼šå¢åŠ å¯¹å†²
            return "increase_hedge", 0.30  # å¢åŠ å¯¹å†² 30%
        elif self.tail_risk_level == "high":
            # é«˜å°¾éƒ¨é£é™©ï¼šé€‚åº¦å¯¹å†²
            return "increase_hedge", 0.10  # å¢åŠ å¯¹å†² 10%
        elif self.tail_risk_level == "normal":
            # æ­£å¸¸å°¾éƒ¨é£é™©ï¼šå‡å°‘å¯¹å†²
            return "reduce_hedge", 0.05  # å‡å°‘å¯¹å†² 5%
        else:
            # å…¶ä»–æƒ…å†µï¼šä¿æŒ
            return "hold_hedge", 0.0
    
    def execute_hedge(self, signal):
        """
        æ‰§è¡Œå¯¹å†²äº¤æ˜“
        """
        if signal[0] == "increase_hedge":
            # å¢åŠ å¯¹å†²
            hedge_size = self.risk_exposure * self.params.max_exposure
            if self.params.hedge_asset == "PUT_OPTIONS":
                # ä¹°å…¥çœ‹è·ŒæœŸæƒ
                self.order = self.buy(data=self.datas[0], size=hedge_size)
                print(f"ä¹°å…¥çœ‹è·ŒæœŸæƒå¯¹å†²ï¼Œé£é™©æ•å£: {hedge_size:.2f}")
            elif self.params.hedge_asset == "VIX_FUTURES":
                # åšå¤š VIX æœŸè´§
                self.order = self.buy(data=self.datas[1], size=hedge_size)
                print(f"åšå¤š VIX æœŸè´§å¯¹å†²ï¼Œé£é™©æ•å£: {hedge_size:.2f}")
        
        elif signal[0] == "reduce_hedge":
            # å‡å°‘å¯¹å†²
            if self.hedge_position:
                self.order = self.close(self.hedge_position)
                self.hedge_position = None
                print(f"å¹³ä»“å¯¹å†²å¤´å¯¸")
        
        elif signal[0] == "hold_hedge":
            # æŒæœ‰å¯¹å†²
            pass
```

---

## ğŸ”— å‚è€ƒé“¾æ¥

- **åŸå§‹æ–‡æ¡£**: `007_Crash-Protecting_Your_Portfolio_With_CrashMetrics_Jonathan_Kinlay.html`
- **Jonathan Kinlay**: https://www.jonathankinlay.com/
- **CrashMetrics**: RiskMetrics åº“æ–‡æ¡£ - https://www.riskmetrics.com/
- **å°¾éƒ¨é£é™©æ–‡çŒ®**: Artzner, Embrechts, Delbaen (1999) "Coherent Risk Measures"
- **VaR æ–‡çŒ®**: Jorion (1997) "Value at Risk: The New Benchmark for Controlling Market Risk"

---

## ğŸ“ æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. âœ… **å°¾éƒ¨é£é™©åº¦é‡**ï¼šä½¿ç”¨ CrashMetrics å‡†ç¡®åº¦é‡å°¾éƒ¨é£é™©
2. âœ… **åŠ¨æ€å¯¹å†²**ï¼šæ ¹æ®é£é™©æ°´å¹³åŠ¨æ€è°ƒæ•´å¯¹å†²æ¯”ä¾‹
3. âœ… **é£é™©æ§åˆ¶**ï¼šä¸¥æ ¼çš„é£é™©æ§åˆ¶å’Œæœ€å¤§å›æ’¤é™åˆ¶
4. âœ… **æç«¯äº‹ä»¶ä¿æŠ¤**ï¼šä¿æŠ¤æŠ•èµ„ç»„åˆå…å—æç«¯å¸‚åœºäº‹ä»¶
5. âœ… **å­¦æœ¯æ”¯æ’‘**ï¼šåŸºäºå°¾éƒ¨é£é™©ç†è®ºå’Œå­¦æœ¯ç ”ç©¶

### é€‚ç”¨åœºæ™¯

- âœ… **æç«¯å¸‚åœºç¯å¢ƒ**ï¼šé€‚åˆåœ¨æç«¯å¸‚åœºç¯å¢ƒä¸­ä¿æŠ¤æŠ•èµ„ç»„åˆ
- âœ… **é«˜é£é™©æŠ•èµ„ç­–ç•¥**ï¼šé€‚åˆä½œä¸ºé«˜é£é™©æŠ•èµ„ç­–ç•¥çš„é£é™©ç®¡ç†å·¥å…·
- âœ… **æœºæ„æŠ•èµ„**ï¼šé€‚åˆæœºæ„æŠ•èµ„è€…çš„é£é™©æ§åˆ¶
- âœ… **å…»è€é‡‘æŠ•èµ„**ï¼šé€‚åˆå…»è€é‡‘çš„é£é™©æ§åˆ¶

### ä¸‹ä¸€æ­¥

1. **å¼€å‘é£é™©ç³»ç»Ÿ**ï¼šå®ç° CrashMetrics é£é™©åº¦é‡ç³»ç»Ÿ
2. **å¼€å‘å¯¹å†²ç³»ç»Ÿ**ï¼šå®ç°åŠ¨æ€å¯¹å†²ç³»ç»Ÿ
3. **å›æµ‹éªŒè¯**ï¼šä½¿ç”¨å†å²æ•°æ®å›æµ‹ç­–ç•¥
4. **æ¨¡æ‹Ÿäº¤æ˜“**ï¼šåœ¨æ¨¡æ‹Ÿç¯å¢ƒä¸­æµ‹è¯•ç­–ç•¥
5. **å®ç›˜éªŒè¯**ï¼šå°èµ„é‡‘å®ç›˜éªŒè¯ç­–ç•¥

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2026-02-02
**ç­–ç•¥ç¼–å·**: 006
**ç­–ç•¥ç±»å‹**: é£é™©ç®¡ç† / é£é™©å¯¹å†²
**çŠ¶æ€**: âœ… é«˜è´¨é‡å®Œæˆ
